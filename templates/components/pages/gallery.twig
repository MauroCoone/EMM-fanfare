{% set page = page ?? 1 %}
{% set entryLimit = 6 %} {# Define the limit for entries per page #}
{% set entryQuery = craft.entries.section("paginas").limit(entryLimit) %}

{% set pageInfo = sprig.paginate(entryQuery, page) %}
{% set entries = pageInfo.pageResults %}

{% for entry in entries %}
    {% set images = entry.afbeeldingen %}
    {% if images | length %}
        {% set imagePageParam = 'imagePage' ~ entry.id %}
        {% set imagePage = craft.app.request.getQueryParam(imagePageParam, 1) %}
        {% set imageLimit = 6 %} {# Define the limit for images per page #}
        
        {% set totalImages = images | length %}
        {% set totalImagePages = (totalImages / imageLimit) | round(0, 'ceil') %}
        {% set start = (imagePage - 1) * imageLimit %}
        {% set end = start + imageLimit %}
        
        {% set paginatedImages = images|slice(start, imageLimit) %}

        <section class="max-w-[80%] mx-auto">
            <div class="mt-[3rem] grid grid-cols-3 gap-4">
                {% for image in paginatedImages %}
                    <div class="w-full h-[50vh] bg-cover bg-center" style="background-image: url('{{ image.url }}');" title="{{ image.title }}"></div>
                {% endfor %}

            </div>
            <div class="pagination my-[2rem]">
                {% if imagePage > 1 %}
                    <a href="?page={{ page }}&{{ imagePageParam }}={{ imagePage - 1 }}"><button class="button">Vorige</button></a>
                {% endif %}
                
                {% if imagePage < totalImagePages %}
                    <a href="?page={{ page }}&{{ imagePageParam }}={{ imagePage + 1 }}"><button class="button">Volgende</button></a>
                {% endif %}
            </div>
        </section>
        
    {% endif %}
{% endfor %}
